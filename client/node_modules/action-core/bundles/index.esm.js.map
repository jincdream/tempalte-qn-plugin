{"version":3,"file":"index.esm.js","sources":["../../node_modules/_ts-brand-json@0.1.1@ts-brand-json/index.js","../../src/index.ts"],"sourcesContent":["exports.JSON = JSON;\n","/**\n * JSON type\n * https://github.com/microsoft/TypeScript/issues/27930\n */\nimport { JSON, json } from 'ts-brand-json'\ntype Types<T, D> = { [type in keyof T]: Trigger<T, D> }\ntype Trigger<T, D> = (param: { target: string; data: D }) => T[keyof T]\nexport default class ActionCore<AllTypes> {\n  private handles: Types<AllTypes, {}> = {} as Types<AllTypes, {}>\n  install<D>(type: keyof AllTypes, actionTrigger: Trigger<AllTypes, D>) {\n    Object.defineProperty(this.handles, type, {\n      value: actionTrigger,\n    })\n  }\n  uninstall(type: keyof AllTypes) {\n    Object.defineProperty(this.handles, type, {\n      value: void 0,\n    })\n    delete this.handles[type]\n  }\n  async run<\n    Param extends { [key: string]: any },\n    Reseponse extends AllTypes[keyof AllTypes] = AllTypes[keyof AllTypes]\n  >(action: {\n    type: keyof AllTypes\n    target: string\n    param?: json<Param>\n    data?: Param\n    [key: string]: any\n  }): Promise<Reseponse> {\n    let { type, param, data, target, ...option } = action\n    let handle = this.handles[type]\n    let paramData: Param = {} as Param\n    if (param) {\n      try {\n        paramData = JSON.parse<Param>(param)\n      } catch (error) {\n        console.error(\n          `[Action-Core Error]: action param parse error â†“\\n`,\n          error\n        )\n      }\n    }\n    let [_target, urlParams = ''] = target.split('?')\n    let urlData: { [key: string]: any } = {}\n    urlParams.split('&').map((v) => {\n      let [key, value] = v.split('=')\n      urlData[key] = value\n    })\n\n    return handle({\n      target: _target,\n      data: { ...paramData, ...data, ...option, ...urlData },\n    }) as Reseponse\n  }\n}\n"],"names":["JSON"],"mappings":"AAAA,UAAY,GAAG,IAAI;;ACAnB;;;;AAIA,MAGqB,UAAU;IAA/B;QACU,YAAO,GAAwB,EAAyB,CAAA;KA+CjE;IA9CC,OAAO,CAAI,IAAoB,EAAE,aAAmC;QAClE,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE;YACxC,KAAK,EAAE,aAAa;SACrB,CAAC,CAAA;KACH;IACD,SAAS,CAAC,IAAoB;QAC5B,MAAM,CAAC,cAAc,CAAC,IAAI,CAAC,OAAO,EAAE,IAAI,EAAE;YACxC,KAAK,EAAE,KAAK,CAAC;SACd,CAAC,CAAA;QACF,OAAO,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;KAC1B;IACD,MAAM,GAAG,CAGP,MAMD;QACC,IAAI,EAAE,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,MAAM,EAAE,GAAG,MAAM,CAAA;QACrD,IAAI,MAAM,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAA;QAC/B,IAAI,SAAS,GAAU,EAAW,CAAA;QAClC,IAAI,KAAK,EAAE;YACT,IAAI;gBACF,SAAS,GAAGA,MAAI,CAAC,KAAK,CAAQ,KAAK,CAAC,CAAA;aACrC;YAAC,OAAO,KAAK,EAAE;gBACd,OAAO,CAAC,KAAK,CACX,mDAAmD,EACnD,KAAK,CACN,CAAA;aACF;SACF;QACD,IAAI,CAAC,OAAO,EAAE,SAAS,GAAG,EAAE,CAAC,GAAG,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;QACjD,IAAI,OAAO,GAA2B,EAAE,CAAA;QACxC,SAAS,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;YACzB,IAAI,CAAC,GAAG,EAAE,KAAK,CAAC,GAAG,CAAC,CAAC,KAAK,CAAC,GAAG,CAAC,CAAA;YAC/B,OAAO,CAAC,GAAG,CAAC,GAAG,KAAK,CAAA;SACrB,CAAC,CAAA;QAEF,OAAO,MAAM,CAAC;YACZ,MAAM,EAAE,OAAO;YACf,IAAI,EAAE,EAAE,GAAG,SAAS,EAAE,GAAG,IAAI,EAAE,GAAG,MAAM,EAAE,GAAG,OAAO,EAAE;SACvD,CAAc,CAAA;KAChB;CACF;;;;"}